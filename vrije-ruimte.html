<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Vrije ruimte | Portfolio</title>
  <meta name="description" content="3 Vrije ruimte | Portfolio" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Vrije ruimte | Portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Vrije ruimte | Portfolio" />
  
  
  

<meta name="author" content="Voornaam achternaam" />


<meta name="date" content="2025-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plan-voor-de-toekomst.html"/>
<link rel="next" href="data-management.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Curriculum Vitae</a></li>
<li class="chapter" data-level="2" data-path="plan-voor-de-toekomst.html"><a href="plan-voor-de-toekomst.html"><i class="fa fa-check"></i><b>2</b> Plan voor de toekomst</a></li>
<li class="chapter" data-level="3" data-path="vrije-ruimte.html"><a href="vrije-ruimte.html"><i class="fa fa-check"></i><b>3</b> Vrije ruimte</a></li>
<li class="chapter" data-level="4" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>4</b> Data management</a></li>
<li class="chapter" data-level="5" data-path="reproducible.html"><a href="reproducible.html"><i class="fa fa-check"></i><b>5</b> Reproducible</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reproducible.html"><a href="reproducible.html#deel-1"><i class="fa fa-check"></i><b>5.1</b> Deel 1</a></li>
<li class="chapter" data-level="5.2" data-path="reproducible.html"><a href="reproducible.html#deel-2"><i class="fa fa-check"></i><b>5.2</b> Deel 2</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>6</b> SQL</a></li>
<li class="chapter" data-level="7" data-path="package-maken.html"><a href="package-maken.html"><i class="fa fa-check"></i><b>7</b> Package maken</a></li>
<li class="chapter" data-level="8" data-path="project-referenties.html"><a href="project-referenties.html"><i class="fa fa-check"></i><b>8</b> Project referenties</a></li>
<li class="chapter" data-level="9" data-path="parameters-in-rmarkdown.html"><a href="parameters-in-rmarkdown.html"><i class="fa fa-check"></i><b>9</b> Parameters in Rmarkdown</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vrije-ruimte" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Vrije ruimte<a href="vrije-ruimte.html#vrije-ruimte" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Nieuwe skill</strong></p>
<p>Ik ben op zoek naar een stage in de richting van medicijnontwikkeling, daarom probeer ik de skill die ik ga leren hierop aan te passen. Na onderzoek is gebleken dat er veel gebruik wordt gemaakt van machine learning voor het maken van antilichamen. Hierom wil ik in de vrije ruimte een package leren die wordt gebruikt voor antilichaamontwikkeling.</p>
<p>Ik ben van plan deze skill te leren door uit te zoeken welke package het meest gebruikt wordt voor antilichaamontwikkeling. De package ga ik helemaal doornemen, dit houdt in alle opties lezen en leren wat deze opties betekenen of in welke situatie welke optie nodig is. Deze package ga ik uittesten op proefdata die ik online ga zoeken. Het resultaat van deze test zal bewijzen of ik de package goed kan gebruiken.
Ik probeer binnen 4 uur een package te vinden die ik ga gebruiken. Hier valt ook het downloaden van de package onder.
Ik wil 8 uur spenderen aan het leren van de package, het doornemen van de verscheidene opties.
18 uur probeer ik de package uit op proefdata. Hier zal ik ook de verschillende opties binnen de package uitproberen om te kijken wat er veranderd.
De laatste 2 uur wordt gebruikt om de resultaten vast te leggen en een conclusie te maken.</p>
<p>Ik heb packages gezocht om mee te werken. Eerst kwam ik epitopepredict tegen, maar dit bleek een Python package te zijn. Hierom koos ik voor immunarch, deze kwam ik iets later tegen. De werking is net anders, epitopepredict kan een voorspelling geven over MHC1 en MHC2 epitopen. Immunarch analyseert data en voorspelt de TCR en BCR van de imuuncellen. Aangezien immunarch wel een R package is heb ik hiervoor gekozen.</p>
<p>In de eerste paar code chunk wordt de ‘lightning-fast start’ uitgeprobeerd. Ook om te kijken wat voor data analyse eruit komt.</p>
<p>Eerst package installeren</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="vrije-ruimte.html#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;immunarch&quot;</span>)           <span class="co"># Install the package</span></span></code></pre></div>
<pre><code>## package &#39;immunarch&#39; successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  C:\Users\justu\AppData\Local\Temp\RtmpEbOVrM\downloaded_packages</code></pre>
<p>Package activeren, daarnaast ook de test dataset activeren.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="vrije-ruimte.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(immunarch); <span class="fu">data</span>(immdata)       <span class="co"># Load the package and the test dataset</span></span></code></pre></div>
<p>Vanaf hier is te zien dat alle grafieken worden gegenereerd met vis(). Deze functie kan alle data die door Immunarch wordt gebruikt herkennen en zelf daarop de grafiek aanpassen.</p>
<p>De functie repOverlap laat de overlap zien tussen repertoires. De imuun receptor sequenties die overeenkomen tussen repertoires. In deze grafiek is te zien dat A2-i132 en A2-i133 erg veel overlap hebben.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="vrije-ruimte.html#cb4-1" tabindex="-1"></a><span class="fu">repOverlap</span>(immdata<span class="sc">$</span>data) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()      <span class="co"># Compute and visualise the most important statistics:</span></span></code></pre></div>
<p><img src="_main_files/figure-html/visualise-1.png" width="672" />
geneUsage() is een functie die berekent hoeveel het immunorecepetor gen wordt gebruikt. In de test data is te zien dat TRBV5-1 erg actief is.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="vrije-ruimte.html#cb5-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()  <span class="co">#     public clonotypes, gene usage, sample diversity</span></span></code></pre></div>
<p><img src="_main_files/figure-html/clonotypes-1.png" width="672" /></p>
<p>repDiversity kan de repertoire diversiteit berekenen. Het aantal verschillende soorten of objecten, worden berekent. Hier zijn vele verschillende methoden voor, repDiversity pakt als standaard Chao1 wat het aantal soorten in de populatie voorspelt.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="vrije-ruimte.html#cb6-1" tabindex="-1"></a><span class="fu">repDiversity</span>(immdata<span class="sc">$</span>data) <span class="sc">%&gt;%</span> <span class="fu">vis</span>(<span class="at">.by =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">.meta =</span> immdata<span class="sc">$</span>meta)      <span class="co"># Group samples</span></span></code></pre></div>
<p><img src="_main_files/figure-html/grouping-1.png" width="672" /></p>
<p>Om de functies beter te begrijpen zoek ik de ?help van functies op.</p>
<p>De dataset die gebruikt wordt bestaat uit meerdere tibbles, eerst een lijst met genen. Daarna hoe de dataset er per gen uitziet. Als laatste een dataset met de metadata (informatie over waar de data vandaan komt).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="vrije-ruimte.html#cb7-1" tabindex="-1"></a>immdata<span class="sc">$</span>data<span class="sc">$</span><span class="st">`</span><span class="at">A2-i129</span><span class="st">`</span></span></code></pre></div>
<pre><code>## # A tibble: 6,532 × 15
##    Clones Proportion CDR3.nt    CDR3.aa V.name D.name J.name V.end D.start D.end
##     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt;   &lt;int&gt; &lt;int&gt;
##  1    173    0.0204  TGCGCCAGC… CASSQE… TRBV4… TRBD1  TRBJ2…    16      18    26
##  2    163    0.0192  TGCGCCAGC… CASSYR… TRBV4… TRBD1  TRBJ2…    11      13    18
##  3     66    0.00776 TGTGCCACC… CATSTN… TRBV15 TRBD1  TRBJ2…    11      16    22
##  4     54    0.00635 TGTGCCACC… CATSIG… TRBV15 TRBD2  TRBJ2…    11      19    25
##  5     48    0.00565 TGTGCCAGC… CASSPW… TRBV27 TRBD1  TRBJ1…    11      16    23
##  6     48    0.00565 TGCGCCAGC… CASQGD… TRBV4… TRBD1  TRBJ1…     8      13    19
##  7     40    0.00471 TGCGCCAGC… CASSQD… TRBV4… TRBD1  TRBJ2…    16      21    26
##  8     31    0.00365 TGTGCCAGC… CASSEE… TRBV2  TRBD1  TRBJ1…    15      17    20
##  9     30    0.00353 TGCGCCAGC… CASSQP… TRBV4… TRBD1  TRBJ2…    14      23    28
## 10     28    0.00329 TGTGCCAGC… CASSWV… TRBV6… TRBD1  TRBJ2…    12      20    25
## # ℹ 6,522 more rows
## # ℹ 5 more variables: J.start &lt;int&gt;, VJ.ins &lt;dbl&gt;, VD.ins &lt;dbl&gt;, DJ.ins &lt;dbl&gt;,
## #   Sequence &lt;lgl&gt;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="vrije-ruimte.html#cb9-1" tabindex="-1"></a>immdata<span class="sc">$</span>meta</span></code></pre></div>
<pre><code>## # A tibble: 12 × 6
##    Sample  ID    Sex     Age Status Lane 
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
##  1 A2-i129 C1    M        11 C      A    
##  2 A2-i131 C2    M         9 C      A    
##  3 A2-i133 C4    M        16 C      A    
##  4 A2-i132 C3    F         6 C      A    
##  5 A4-i191 C8    F        22 C      B    
##  6 A4-i192 C9    F        24 C      B    
##  7 MS1     MS1   M        12 MS     C    
##  8 MS2     MS2   M        30 MS     C    
##  9 MS3     MS3   M         8 MS     C    
## 10 MS4     MS4   F        14 MS     C    
## 11 MS5     MS5   F        15 MS     C    
## 12 MS6     MS6   F        15 MS     C</code></pre>
<p>Bij veel voorbeelden die volgen wordt de vis() functie ook erachteraan geplakt. Deze functie maakt het resultaat van de code overzichtelijker. Daarnaast kan met vis() een .by optie gebruikt worden om te groeperen op metadata zoals geslacht.</p>
<p>repExplore wordt gebruikt om een eerste indruk te krijgen van de data. De functie kan standaard statistiek berekenen voor een repertoire. De optie .method bepaalt wat berekent wordt voor je repertoire. In het voorbeeld is “volume” gebruikt wat het aantal unieke receptor clonotypes berekent. Andere mogelijkheden zijn: “count” voor de relatieve dichtheid, “len” om sequentie lengte te berekenen. “clones” geeft het aantal clones in het repertoire.</p>
<p>repExplore heeft een .col optie om aan te geven of het gaat over nucleotiden (“nt”) of aminozuren (“aa”)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="vrije-ruimte.html#cb11-1" tabindex="-1"></a><span class="fu">repExplore</span>(immdata<span class="sc">$</span>data, <span class="at">.method =</span> <span class="st">&quot;volume&quot;</span>)</span></code></pre></div>
<pre><code>##          Sample Volume
## A2-i129 A2-i129   6443
## A2-i131 A2-i131   6375
## A2-i133 A2-i133   6300
## A2-i132 A2-i132   6721
## A4-i191 A4-i191   5058
## A4-i192 A4-i192   5763
## MS1         MS1   5301
## MS2         MS2   7043
## MS3         MS3   6310
## MS4         MS4   7313
## MS5         MS5   5588
## MS6         MS6   7278</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="vrije-ruimte.html#cb13-1" tabindex="-1"></a><span class="fu">repExplore</span>(immdata<span class="sc">$</span>data, <span class="at">.method =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>(<span class="at">.by =</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Lane&quot;</span>), immdata<span class="sc">$</span>meta)</span></code></pre></div>
<p><img src="_main_files/figure-html/repexplore2-1.png" width="672" />
fixVis() wordt gebruikt om grafieken publicatie klaar te maken.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="vrije-ruimte.html#cb14-1" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">vis</span>(exp_len, <span class="at">.by =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">.meta =</span> immdata<span class="sc">$</span>meta)</span>
<span id="cb14-2"><a href="vrije-ruimte.html#cb14-2" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="_main_files/figure-html/repexplore4-1.png" width="672" />
Met repclonality kan de clonale proporties gemeten worden. De .method kan verschillen. In dit voorbeeld wordt “homeo” gebruikt voor de .method, deze meet de relatieve dichtheid als deel van het hele repertoire door clonale groepen. “clonal.prop” meet de clonale proportie, “top” meet de 10 grootste clonotypes en “rare” berekent de de groepen met de laagste of ‘zeldzaamste’ clonotypes.
Voor “homeo” kan je .clone.types gebruiken om aan te geven wat de proportie van de dichtheid is. Zonder invoer worden de getallen gekoppeld aan de groottes in de grafiek hieronder.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="vrije-ruimte.html#cb15-1" tabindex="-1"></a><span class="fu">repClonality</span>(immdata<span class="sc">$</span>data, <span class="at">.method =</span> <span class="st">&quot;homeo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>(<span class="at">.by =</span> <span class="st">&quot;Sex&quot;</span>, immdata<span class="sc">$</span>meta)</span></code></pre></div>
<p><img src="_main_files/figure-html/repclonality-1.png" width="672" />
repFilter() werkt als filter(), met deze functie kan je data selecteren die je wilt gebruiken of juist data weglaten. .method heeft de inputs: “by.clonotype” (wat de standaard is), “by.meta” en “by.rep”. In voorbeeld hieronder wordt het mannelijk geslacht eruit gefilterd. exclude kan worden vervangen met ‘morethan’, ‘lessthan’ en ‘interval’ om aan te geven dat je de waardes tussen 2 mogelijkheden wilt gebruiken.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="vrije-ruimte.html#cb16-1" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> <span class="fu">repFilter</span>(immdata, <span class="at">.method =</span> <span class="st">&quot;by.meta&quot;</span>, <span class="at">.query =</span> <span class="fu">list</span>(<span class="at">Sex =</span> <span class="fu">exclude</span>(<span class="st">&quot;M&quot;</span>)))<span class="sc">$</span>meta</span>
<span id="cb16-2"><a href="vrije-ruimte.html#cb16-2" tabindex="-1"></a>filtered</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   Sample  ID    Sex     Age Status Lane 
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
## 1 A2-i132 C3    F         6 C      A    
## 2 A4-i191 C8    F        22 C      B    
## 3 A4-i192 C9    F        24 C      B    
## 4 MS4     MS4   F        14 MS     C    
## 5 MS5     MS5   F        15 MS     C    
## 6 MS6     MS6   F        15 MS     C</code></pre>
<p>Bij repOverlap kan de optie .col gegeven worden. Dit kan erg nuttig zijn als een gen wat voor het epitoop codeert wordt vergeleken. repOverlap gebruikt standaard de aminozuur sequenties als de optie niet wordt aangegeven, hieronder is dit aangepast naar “nt” voor nucleotiden sequenties.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="vrije-ruimte.html#cb18-1" tabindex="-1"></a><span class="fu">repOverlap</span>(immdata<span class="sc">$</span>data, <span class="at">.col =</span> <span class="st">&quot;nt&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/repoverlap%20col-1.png" width="672" /></p>
<p>De .col accepteert V gene segments, J gene segments en D gene segments als invoer. Dit is gedaan in de grafiek hieronder met de V gene segments. Je ziet dat als er specifieker wordt gekeken er andere genen meer kunnen overlappen, hier bijvoorbeeld de genen A2-i129 en A2-i132.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="vrije-ruimte.html#cb19-1" tabindex="-1"></a><span class="fu">repOverlap</span>(immdata<span class="sc">$</span>data, <span class="at">.col =</span> <span class="st">&quot;nt+v&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/repoverlap%20col2-1.png" width="672" /></p>
<p>repOverlap kan andere methode gebruiken. Hieronder wordt de “jaccard” methode gebruikt. Deze laat het percentage wat overeenkomt zien ten opzicht van het geheel. In dit geval wordt de grafiek onduidelijk omdat de getallen erg lang zijn, wel is te zien dat met deze methode dezelfde genen overlappen aangezien dezelfde hokjes rood of roder worden. Zie figuur bij chunk repoverlap col</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="vrije-ruimte.html#cb20-1" tabindex="-1"></a><span class="fu">repOverlap</span>(immdata<span class="sc">$</span>data, <span class="at">.col =</span> <span class="st">&quot;nt&quot;</span>, <span class="at">.method =</span> <span class="st">&quot;jaccard&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<pre><code>##   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</code></pre>
<p><img src="_main_files/figure-html/repoverlap%20method-1.png" width="672" /></p>
<p>Hieronder wordt de methode “cosine” gebruikt. Deze methode meet of er veel overlap zit tussen 2 vectors die de cosinus meten van de hoek die ertussen zit. Op deze manier zijn weer andere genen erg overlappend. Al is deze methode weer niet erg overzichtelijk door getallen met veel decimalen.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="vrije-ruimte.html#cb22-1" tabindex="-1"></a><span class="fu">repOverlap</span>(immdata<span class="sc">$</span>data, <span class="at">.col =</span> <span class="st">&quot;nt&quot;</span>, <span class="at">.method =</span> <span class="st">&quot;cosine&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<pre><code>##   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</code></pre>
<p><img src="_main_files/figure-html/repoverlap%20method2-1.png" width="672" /></p>
<p>Voor geneUsage kan je per gensoort kijken naar de usage, zolang er een ‘species’ bij gegeven wordt. als voorbeeld: gene = “HomoSapiens.TRBJ”. Hieronder wordt dit voorbeeld uitgevoerd, je ziet het gebruik van alle TRBJ gen soorten.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="vrije-ruimte.html#cb24-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data[[<span class="dv">1</span>]], <span class="at">.gene =</span> <span class="st">&quot;HomoSapiens.TRBJ&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/geneUsage-1.png" width="672" /></p>
<p>Om meer informatie te krijgen over de soorten genen kan gene_stats() gebruikt worden. gene_stats() laat de alias zien van de ‘species’ naast de kolom met de ‘species’. Dan zie je de kolommen met genes en het aantal dat de ‘species’ ervan hebben.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="vrije-ruimte.html#cb25-1" tabindex="-1"></a><span class="fu">gene_stats</span>()</span></code></pre></div>
<pre><code>##     alias                 species ighd ighj ighv igij igkj igkv iglj iglv traj
## 1      bt               BosTaurus   21    4   25    0    1    6    5   26   46
## 2      cd      CamelusDromedarius    0    0    0    0    0    0    0    0    0
## 3     clf    CanisLupusFamiliaris    0    0    0    0    0    0    0    0    0
## 4      dr              DanioRerio    7    7    0    3    0    0    0    0    0
## 5      hs             HomoSapiens   30   13  248    0    5   64    7   69   57
## 6  macmul           MacacaMulatta   24    7   19    0    4   83    5    0    0
## 7     mmc    MusMusculusCastaneus    0    0    0    0    0    4    0    0    0
## 8     mmd   MusMusculusDomesticus    0    0    0    0    0    2    0    0    0
## 9  musmus             MusMusculus   32    8  225    0    8  109    3    5   42
## 10     oa OrnithorhynchusAnatinus    3   10    0    0    0    0    0    0    0
## 11     oc    OryctolagusCuniculus   10   11   39    0    8   26    2   20    0
## 12     om      OncorhynchusMykiss    9    7    6    0    0    0    0    0    0
## 13     rn        RattusNorvegicus   30    4  113    0    6  132    2    8    0
## 14   smth   MusMusculusMolossinus    0    0    0    0    0    1    0    0    0
## 15   smth     MusMusculusMusculus    0    0    0    0    0    1    0    0    0
## 16   smth              MusSpretus    0    0    0    0    0    2    0    2    0
## 17     ss               SusScrofa    5    5   15    0    8   19    4   14    0
##    trav trbd trbj trbv trdd trdj trdv trgj trgv
## 1     0    0    0    0    5    3    0    6   15
## 2     0    0    0    0    0    0    7    2    2
## 3     0    2    8   19    0    0    0    7    8
## 4     0    0    0    0    0    0    0    0    0
## 5    60    3   14   64    3    4    6    4   10
## 6     0    2   15   58    0    0    0    0    0
## 7     0    0    0    0    0    0    0    0    0
## 8     0    0    0    0    0    0    0    0    0
## 9   145    2   14   23    2    3    7    0   11
## 10    0    0    0    0    0    0    0    0    0
## 11    0    0    0    0    0    0    0    0    0
## 12    0    1    9    0    0    0    0    0    0
## 13    0    0    0    0    0    0    0    0    0
## 14    0    0    0    0    0    0    0    0    0
## 15    0    0    0    0    0    0    0    0    0
## 16    0    0    0    0    0    0    0    0    0
## 17    0    0    0    0    0    0    0    0    0</code></pre>
<p>Nu testen we een voorbeeld uit de gene_stats grafiek. We pakken de RattusNorvegicus met IGHD.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="vrije-ruimte.html#cb27-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data, <span class="at">.gene =</span> <span class="st">&quot;RattusNorvegicus.IGHD&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/geneusage2-1.png" width="672" /></p>
<p>geneUsage heeft ook een .ambig optie. Dit is om ‘gene assignments’ te regelen. Deze optie staat standaard op “inc” om alle verschillende gen sequenties mee te nemen. Deze standaard optie wordt eerst getest. Daarna een grafiek waar “exc” is gebruikt. Wat je ziet komt doordat alle genen vallen onder ‘ambiguous’. De dataset kan niet zeker de genen benoemen, bij ‘inc’ neemt geneUsage deze niet zekere genen ook mee. Bij ‘exc’ niet waardoor de genen verdwijnen.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="vrije-ruimte.html#cb28-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data, <span class="at">.gene =</span> <span class="st">&quot;BosTaurus.IGHV&quot;</span>, <span class="at">.ambig =</span> <span class="st">&quot;inc&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/geneusage3-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="vrije-ruimte.html#cb29-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data, <span class="at">.gene =</span> <span class="st">&quot;BosTaurus.IGHV&quot;</span>, <span class="at">.ambig =</span> <span class="st">&quot;exc&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/geneusage4-1.png" width="672" /></p>
<p>geneUsage heeft ook een .type optie welke accepteert de waardes: “segment”, “allele” en “family”. Voor segment worden alle segmenten gepakt, bij allele alle allelen en family pakt de groep. Zoals te zien bij geneusage6 verandert TRBV10-1, TRBV10-2 en TRBV10-3 in 1 groep genaamd TRBV10</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="vrije-ruimte.html#cb30-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data[[<span class="dv">1</span>]], <span class="at">.type =</span><span class="st">&quot;allele&quot;</span>) <span class="sc">%&gt;%</span> vis</span></code></pre></div>
<p><img src="_main_files/figure-html/geneusage5-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="vrije-ruimte.html#cb31-1" tabindex="-1"></a><span class="fu">geneUsage</span>(immdata<span class="sc">$</span>data[[<span class="dv">1</span>]], <span class="at">.type =</span><span class="st">&quot;family&quot;</span>) <span class="sc">%&gt;%</span> vis</span></code></pre></div>
<p><img src="_main_files/figure-html/geneusage6-1.png" width="672" /></p>
<p>repDiversity heeft opties die hetzelfde werken als bij eerdere functies, zoals .col waarmee de kolom word aangegeven(“aa” of “nt”). repDiversity heeft ook een .method optie, deze heeft echter andere methodes waarmee gewerkt worden. De methode hier heeft invloed op wat er berekent wordt. In het voorbeeld hieronder is de Inverse Simpson manier gebruikt. Deze methode kan de ongelijkheid berekenen zodat niet één clonotype overheerst. Daarnaast gebruikt deze methode een gemiddelde zodat niet alles even veel meetelt.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="vrije-ruimte.html#cb32-1" tabindex="-1"></a><span class="fu">repDiversity</span>(immdata<span class="sc">$</span>data, <span class="at">.method=</span> <span class="st">&quot;inv.simp&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>(<span class="at">.by =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">.meta =</span> immdata<span class="sc">$</span>meta)</span></code></pre></div>
<p><img src="_main_files/figure-html/repdiversity-1.png" width="672" /></p>
<p>De methode d50 berekent het minimum aan verschillende clonotypes wat samen 50% van het alle sequenties zijn. Op deze grafiek is goed te zien of er veel of weinig clones bijdragen aan de 50% en dus of</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="vrije-ruimte.html#cb33-1" tabindex="-1"></a><span class="fu">repDiversity</span>(immdata<span class="sc">$</span>data, <span class="at">.method=</span> <span class="st">&quot;d50&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>(<span class="at">.by =</span> <span class="st">&quot;Status&quot;</span>, <span class="at">.meta =</span> immdata<span class="sc">$</span>meta)</span></code></pre></div>
<p><img src="_main_files/figure-html/repdiversity2-1.png" width="672" /></p>
<p>trackClonotypes is een functie waarmee clonotypes gemakkelijk kunnen worden geselecteerd. De functie heeft tweede input .which, waarmee aan wordt gegeven hoeveel gekozen moet worden, in het voorbeeld hieronder is de eerste input van de optie .which A2-i129, daarom wordt deze repertoire gebruikt, de tweede input van .which is de 5 wat betekent dat er 5 langste sequenties worden geselecteerd. Hier worden sequenties geselecteerd omdat .col staat op “nt+v” waardoor de nucleotiden sequenties met V gene segments gebruikt worden.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="vrije-ruimte.html#cb34-1" tabindex="-1"></a>tc1 <span class="ot">&lt;-</span> <span class="fu">trackClonotypes</span>(immdata<span class="sc">$</span>data, <span class="fu">list</span>(<span class="st">&quot;A2-i129&quot;</span>, <span class="dv">5</span>), <span class="at">.col =</span> <span class="st">&quot;nt+v&quot;</span>)</span>
<span id="cb34-2"><a href="vrije-ruimte.html#cb34-2" tabindex="-1"></a>tc1</span></code></pre></div>
<pre><code>## Key: &lt;CDR3.nt, V.name&gt;
##                                                CDR3.nt  V.name     A2-i129
##                                                 &lt;char&gt;  &lt;char&gt;       &lt;num&gt;
## 1:    TGCGCCAGCAGCCAAGAAGGGACAGGGTATTCCGGGGAGCTGTTTTTT TRBV4-1 0.020352941
## 2:          TGCGCCAGCAGCTACAGGGTTGGCACAGATACGCAGTATTTT TRBV4-1 0.019176471
## 3: TGTGCCACCAGCACCAACAGGGGCGGAACCCCAGCAGATACGCAGTATTTT  TRBV15 0.007764706
## 4:          TGTGCCACCAGCATCGGAGGCGGGAGCTACGAGCAGTACTTC  TRBV15 0.006352941
## 5:          TGTGCCAGCAGTCCTTGGACAGGGAGTATGGCCCTCCACTTT  TRBV27 0.005647059
##    A2-i131 A2-i133 A2-i132 A4-i191 A4-i192   MS1   MS2   MS3   MS4   MS5   MS6
##      &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;
## 1:       0       0       0       0       0     0     0     0     0     0     0
## 2:       0       0       0       0       0     0     0     0     0     0     0
## 3:       0       0       0       0       0     0     0     0     0     0     0
## 4:       0       0       0       0       0     0     0     0     0     0     0
## 5:       0       0       0       0       0     0     0     0     0     0     0</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="vrije-ruimte.html#cb36-1" tabindex="-1"></a><span class="fu">vis</span>(tc1)</span></code></pre></div>
<p><img src="_main_files/figure-html/trackclonotypes2-1.png" width="672" /></p>
<p>Met trackClonotypes kan ook een nucleotide sequentie getracked worden. Dit werkt ook als er meerdere sequenties in een lijst worden gezet.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="vrije-ruimte.html#cb37-1" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="st">&quot;CASSLEETQYF&quot;</span></span>
<span id="cb37-2"><a href="vrije-ruimte.html#cb37-2" tabindex="-1"></a><span class="fu">trackClonotypes</span>(immdata<span class="sc">$</span>data, sequence, <span class="at">.col =</span> <span class="st">&quot;aa&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/trackclonotypes3-1.png" width="672" /></p>
<p>Eerder is al aangegeven dat de vis() functie handig is omdat deze de data van immunarch herkent en zelf bedenkt wat voor grafiek moet worden gemaakt. Toch zijn ook voor vis() bepaalde opties om de grafiek meer naar eigen wens te maken. Deze opties staan niet in ?help maar wel in de tutorial online.</p>
<p>.plot kan worden aangepast naar: “smooth”, “area” of “line”.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="vrije-ruimte.html#cb38-1" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CASSLEETQYF&quot;</span>, <span class="st">&quot;CASSDSSGGANEQFF&quot;</span>, <span class="st">&quot;CASSDSSGSTDTQYF&quot;</span>, <span class="st">&quot;CASSLAGGYNEQFF&quot;</span>, <span class="st">&quot;CASSDSAGGTDTQYF&quot;</span>, <span class="st">&quot;CASSLDSYEQYF&quot;</span>, <span class="st">&quot;CASSSAGGYNEQFF&quot;</span>)</span>
<span id="cb38-2"><a href="vrije-ruimte.html#cb38-2" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">trackClonotypes</span>(immdata<span class="sc">$</span>data, target, <span class="at">.col =</span> <span class="st">&quot;aa&quot;</span>)</span>
<span id="cb38-3"><a href="vrije-ruimte.html#cb38-3" tabindex="-1"></a><span class="fu">vis</span>(tc, <span class="at">.plot =</span> <span class="st">&quot;smooth&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/vis%20smooth-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="vrije-ruimte.html#cb39-1" tabindex="-1"></a><span class="fu">vis</span>(tc, <span class="at">.plot =</span> <span class="st">&quot;area&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/area-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="vrije-ruimte.html#cb40-1" tabindex="-1"></a><span class="fu">vis</span>(tc, <span class="at">.plot =</span> <span class="st">&quot;line&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/line-1.png" width="672" /></p>
<p>vis() heeft een .order optie om de volgorde van gegeven data te veranderen.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="vrije-ruimte.html#cb41-1" tabindex="-1"></a><span class="co"># Passing indices</span></span>
<span id="cb41-2"><a href="vrije-ruimte.html#cb41-2" tabindex="-1"></a><span class="fu">names</span>(immdata<span class="sc">$</span>data)[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)] <span class="co"># check sample names</span></span></code></pre></div>
<pre><code>## [1] &quot;A2-i129&quot; &quot;A2-i133&quot; &quot;A4-i191&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="vrije-ruimte.html#cb43-1" tabindex="-1"></a><span class="co"># You can change the order</span></span>
<span id="cb43-2"><a href="vrije-ruimte.html#cb43-2" tabindex="-1"></a><span class="fu">vis</span>(tc, <span class="at">.order =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/order-1.png" width="672" /></p>
<p>De vis() functie kan gebruik maken van scale_fill_brewer om de kleuren aan te passen.</p>
<p>Immunarch kan ook clonotypes identificeren met online databases. De tutorial van immunarch wordt hieronder gevolgd om dit proces te demonstreren. De functies die we in dit gedeelte tegenkomen zullen ook verder onderzocht worden.</p>
<p>Na het downloaden van de SearchTable wordt dbLoad() gebruikt. dbLoad() kan VDJDB, McPAS-TCR en TBAdb databases laden. er zijn een paar opties die in de functie zijn verwerkt zodat de functie weet wat voor data er wordt geladen. De eerste input is de path naar de database, hier wordt de VDJDB database gebruikt die al is gefiltert op ‘species’ HomoSapiens. ‘.species’ is hier HomoSapiens. ‘.chain’ specificeert wat voor chains in de database moeten zitten. We kijken naar TRB chains dus dat wordt ingevoerd. Omdat er in de tutorial gekeken wordt naar het Cytomegalovirus wordt dit aangegeven met .pathology = “CMV”.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="vrije-ruimte.html#cb44-1" tabindex="-1"></a>vdjdb_st <span class="ot">=</span> <span class="fu">dbLoad</span>(<span class="st">&quot;vrije_ruimte/VDJDB_database/SearchTable-2025-05-25 22_39_15.094.tsv&quot;</span>, <span class="st">&quot;vdjdb-search&quot;</span>, <span class="at">.species =</span> <span class="st">&quot;HomoSapiens&quot;</span>, <span class="at">.chain =</span> <span class="st">&quot;TRB&quot;</span>, <span class="at">.pathology =</span> <span class="st">&quot;CMV&quot;</span>)</span>
<span id="cb44-2"><a href="vrije-ruimte.html#cb44-2" tabindex="-1"></a>vdjdb_st</span></code></pre></div>
<pre><code>## # A tibble: 20,572 × 19
##    complex.id Gene  CDR3         V     J     Species `MHC A` `MHC B` `MHC class`
##         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      
##  1          0 TRB   CASSLGVDFNY… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  2          0 TRB   CSVTGTSYEQYF TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  3          0 TRB   CATSSPGLASD… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  4          0 TRB   CASSSPLLSSD… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  5          0 TRB   CASSLSGGLWS… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  6          0 TRB   CSVVGRYYEQYF TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  7          0 TRB   CATSGPSASYE… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  8          0 TRB   CASSFNGPNTE… TRBV… TRBJ… HomoSa… HLA-B*… B2M     MHCI       
##  9          0 TRB   CAISEFGLAGS… TRBV… TRBJ… HomoSa… HLA-B*… B2M     MHCI       
## 10          0 TRB   CASSLFDGTGS… TRBV… TRBJ… HomoSa… HLA-B*… B2M     MHCI       
## # ℹ 20,562 more rows
## # ℹ 10 more variables: Epitope &lt;chr&gt;, `Epitope gene` &lt;chr&gt;,
## #   `Epitope species` &lt;chr&gt;, Reference &lt;chr&gt;, Method &lt;chr&gt;, Meta &lt;chr&gt;,
## #   CDR3fix &lt;chr&gt;, Score &lt;dbl&gt;, Chain &lt;chr&gt;, Pathology &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="vrije-ruimte.html#cb46-1" tabindex="-1"></a><span class="fu">data</span>(immdata)</span></code></pre></div>
<p>Nu kan met dbAnnotate alle clonotypes worden geannoteert. De CDR3 aminozuur sequenties worden gematched met CDR3 sequenties in de VDJdb database. De 3e input van dbAnnotate is .data.col, deze geeft aan welke kolom van je eigen repertoire wordt gematched. De 4e input is de .db.col om de kolom van de database aan te geven waarmee wordt gematched.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="vrije-ruimte.html#cb47-1" tabindex="-1"></a><span class="fu">dbAnnotate</span>(immdata<span class="sc">$</span>data, vdjdb_st, <span class="st">&quot;CDR3.aa&quot;</span>, <span class="st">&quot;CDR3&quot;</span>)</span></code></pre></div>
<pre><code>##            CDR3.aa Samples A2-i129 A2-i131 A2-i133 A2-i132 A4-i191 A4-i192
##             &lt;char&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;
##   1:   CASSLEETQYF      11       3       3       4       7       1       2
##   2:   CASSLGETQYF      11       6       4       2       8       4       0
##   3:   CASSFQETQYF       9       3       2       2       4       2       0
##   4:    CASSQETQYF       9       5       2       1       2       3       2
##   5:   CASSSSYEQYF       9       1       0       0       1       2       2
##  ---                                                                      
## 600:  CSVGTGTYEQYF       1       0       0       0       0       1       0
## 601: CSVQGGAYNEQFF       1       0       1       0       0       0       0
## 602: CSVQGGSYNEQFF       1       0       1       0       0       0       0
## 603:  CSVVATNEKLFF       1       0       0       1       0       0       0
## 604: CSVVGTGNTEAFF       1       0       0       0       0       0       0
##        MS1   MS2   MS3   MS4   MS5   MS6
##      &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;
##   1:     1     0     3     1     1     1
##   2:     1     3     1     2     5     1
##   3:     1     1     0     4     0     2
##   4:     0     1     0     0     4     1
##   5:     1     1     0     1     1     3
##  ---                                    
## 600:     0     0     0     0     0     0
## 601:     0     0     0     0     0     0
## 602:     0     0     0     0     0     0
## 603:     0     0     0     0     0     0
## 604:     0     0     0     0     1     0</code></pre>
<p>In de tabel die dbAnnotate genereert zijn de sequenties te zien in de eerste kolom. De tweede kolom zijn de ‘Samples’. Dit geeft aan hoe veel clonotypes zijn gevonden, waarna de verschillende clonotypes komen en hoevaak ze voorkomen.</p>
<p>Immunarch geeft ook voorbeelden hoe je specifieke epitoop sequenties kan opzoeken. Hiervoor wordt dplyr gebruikt.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="vrije-ruimte.html#cb49-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-2"><a href="vrije-ruimte.html#cb49-2" tabindex="-1"></a><span class="fu">table</span>(vdjdb_st<span class="sc">$</span>Epitope)</span></code></pre></div>
<pre><code>## 
## ARNLVPMVATVQGQN       AYAQKIFKI    CPSQEPMSIYVY       CRVLCCYVL       CVETMCNEY 
##               3              39               5              31               2 
##       DEEDAIAAY EDVPSGKLFMHVTLG      EFFWDANDIY EHPTFTSQYRIQGKL       ELKRKMIYM 
##               2               1               1              30               5 
##       ELRRKMMYM        FPTKDVAL       FRCPRRFCF       IPSINVHHY       KLGGALQAK 
##              11              15              10             105           13681 
## LLQTGIHVRVSQPSL LSEFCRVLCCYVLEE       MLNIPSINV        NEGVKAAW       NLVPMVATV 
##             305               2              73             299            5067 
##       QIKVRVDMV       QIKVRVKMV       QYDPVAALF      RPHERNGFTV     RPHERNGFTVL 
##              22              36              39               4              79 
##      TPRVTGGGAM       VLEETSVML       VMAPRTLIL       VTEHDTLLY       YILEETSVM 
##             343              20               2             205               2 
##     YSEHPTFTSQY 
##             133</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="vrije-ruimte.html#cb51-1" tabindex="-1"></a>vdjdb <span class="ot">&lt;-</span> vdjdb_st <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vdjdb_st<span class="sc">$</span>Epitope <span class="sc">==</span> <span class="st">&quot;NLVPMVATV&quot;</span>)</span>
<span id="cb51-2"><a href="vrije-ruimte.html#cb51-2" tabindex="-1"></a>vdjdb</span></code></pre></div>
<pre><code>## # A tibble: 5,067 × 19
##    complex.id Gene  CDR3         V     J     Species `MHC A` `MHC B` `MHC class`
##         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      
##  1          0 TRB   CASSYSTGTPG… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  2          0 TRB   CASTPAGGAPG… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  3          0 TRB   CASSLAPGATN… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  4          0 TRB   CASSFSGGAPG… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  5          0 TRB   CASSYFGGNTE… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  6          0 TRB   CASSLAPGATS… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  7          0 TRB   CASSYQTGTIY… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  8          0 TRB   CASSPQTGAIY… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
##  9          0 TRB   CASSALGGGGT… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
## 10          0 TRB   CASSPVQGAFY… TRBV… TRBJ… HomoSa… HLA-A*… B2M     MHCI       
## # ℹ 5,057 more rows
## # ℹ 10 more variables: Epitope &lt;chr&gt;, `Epitope gene` &lt;chr&gt;,
## #   `Epitope species` &lt;chr&gt;, Reference &lt;chr&gt;, Method &lt;chr&gt;, Meta &lt;chr&gt;,
## #   CDR3fix &lt;chr&gt;, Score &lt;dbl&gt;, Chain &lt;chr&gt;, Pathology &lt;chr&gt;</code></pre>
<p>De getKmers functie kan Kmers detecteren. Deze berekent hoeveel kmers er aanwezig zijn in een repertoire. Alleen de ‘.k’ optie is nieuw vergeleken met de andere functies. ‘.k’ is een integer die aangeeft hoe lang de kmers moeten zijn. De optie .coding staat standaard op TRUE, deze optie vertelt de functie of niet coderende sequenties moeten worden meegeteld. De standaard filtert alle niet coderende sequenties eruit.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="vrije-ruimte.html#cb53-1" tabindex="-1"></a>kmers <span class="ot">&lt;-</span> <span class="fu">getKmers</span>(immdata<span class="sc">$</span>data[[<span class="dv">1</span>]], <span class="dv">3</span>)</span>
<span id="cb53-2"><a href="vrije-ruimte.html#cb53-2" tabindex="-1"></a>kmers</span></code></pre></div>
<pre><code>## # A tibble: 4,405 × 2
##    Kmer  Count
##    &lt;chr&gt; &lt;int&gt;
##  1 AAA       6
##  2 AAD       5
##  3 AAE       9
##  4 AAF       2
##  5 AAG      37
##  6 AAI       2
##  7 AAK       5
##  8 AAL       4
##  9 AAM       1
## 10 AAN      13
## # ℹ 4,395 more rows</code></pre>
<p>Kmers kan ook met vis() worden gevisualiseerd.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="vrije-ruimte.html#cb55-1" tabindex="-1"></a><span class="fu">vis</span>(kmers)</span></code></pre></div>
<p><img src="_main_files/figure-html/kmers2-1.png" width="672" /></p>
<p>Omdat dit onoverzichtelijk is gebruikt vis() de .head optie om te filteren. In het voorbeeld hieronder worden de 10 meest voorkomende Kmers eruit gefilterd om te visualiseren. De optie ‘.position’ kan worden gebruikt om de positie van de bars aan te passen. ook kan een ‘.log’ optie worden aangepast om de y-axis te transformeren met log.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="vrije-ruimte.html#cb56-1" tabindex="-1"></a>kvisual <span class="ot">&lt;-</span> <span class="fu">vis</span>(kmers, <span class="at">.head =</span> <span class="dv">10</span>)</span>
<span id="cb56-2"><a href="vrije-ruimte.html#cb56-2" tabindex="-1"></a>kvisual</span></code></pre></div>
<p><img src="_main_files/figure-html/.head-1.png" width="672" /></p>
<p>De functie kmer_profile kan daarna een sequentie motif analyse uitvoeren. Met de ‘.method’ optie kan worden aangegeven wat voor matrix eruit moet komen. “freq” is een ‘position frequency matrix’ die aangeeft hoe vaak een patroon zich op welke positie in de kmer bevindt. “prob” om een ‘position probability matrix’ te maken die aangeeft hoe groot de kans is dat een patroon zich op elke positie bevindt, deze optie maakt gebruik van de waardes uit de “freq” matrix. “wei” om een ‘position weight matrix’ wat hetzelfde aangeeft als de ‘position probability matrix’ maar dan na een log transformatie.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="vrije-ruimte.html#cb57-1" tabindex="-1"></a>profile <span class="ot">&lt;-</span> <span class="fu">kmer_profile</span>(kmers, <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb57-2"><a href="vrije-ruimte.html#cb57-2" tabindex="-1"></a>profile</span></code></pre></div>
<pre><code>##    [,1]  [,2]  [,3]
## A  9283  9283  3791
## C  6470    27    27
## D  2131  2131  2131
## E  5872  5872  5872
## F   691  2601  9043
## G  9603  9603  9603
## H   405   684   684
## I  1107  1107  1107
## K  1100  1100  1100
## L  4108  4108  4109
## M   246   246   246
## N  2424  2424  2424
## P  2564  2564  2564
## Q  7087  7087  7087
## R  3506  3506  3504
## S 14031 14031 13082
## T  5671  6269  6269
## V  1927  1927  1927
## W   487   487   487
## Y  2442  6098  6098
## attr(,&quot;class&quot;)
## [1] &quot;immunr_kmer_profile_pfm&quot; &quot;matrix&quot;                 
## [3] &quot;array&quot;</code></pre>
<p>Deze tabel kan met vis() in een grafiek gezet worden. Hier wordt .plot gebruikt om aan te geven wat voor grafiek wordt gemaakt. “text” maakt een scatter plot terwijl de “seq” mogelijkheid het uitdrukt in letters met verbonden aan een kans.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="vrije-ruimte.html#cb59-1" tabindex="-1"></a><span class="fu">vis</span>(profile, <span class="at">.plot =</span> <span class="st">&quot;seq&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/profile2-1.png" width="672" /></p>
<p>Verder heb ik geprobeerd een dataset online te verkrijgen. Dit kreeg ik niet aan de praat. Hierom probeerde ik zelf een dataset te repliceren om te kijken of dat werkte.</p>
<p>Dit deed ik door delen van de gegeven datasets te kopieren naar zelf gemaakte bestanden. Jammer genoeg werkte dit ook niet.</p>
<p>Om toch te proberen dacht ik chatgpt data te laten genereren met de verwachting dat dit niet zou werken.
Aangezien dit niet echt te doen is voor chatgpt komt er een kleine dataset. Toch is er iets te zien in 1 grafiek. De rest werkt niet.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="vrije-ruimte.html#cb60-1" tabindex="-1"></a><span class="co"># Voorbeeld clonotype dataset (één sample)</span></span>
<span id="cb60-2"><a href="vrije-ruimte.html#cb60-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Voor reproduceerbaarheid</span></span>
<span id="cb60-3"><a href="vrije-ruimte.html#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="vrije-ruimte.html#cb60-4" tabindex="-1"></a><span class="co"># Functie om 1 sample te genereren</span></span>
<span id="cb60-5"><a href="vrije-ruimte.html#cb60-5" tabindex="-1"></a>generate_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">10</span>) {</span>
<span id="cb60-6"><a href="vrije-ruimte.html#cb60-6" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb60-7"><a href="vrije-ruimte.html#cb60-7" tabindex="-1"></a>    <span class="at">Clonotype =</span> <span class="fu">paste0</span>(<span class="st">&quot;Clone&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n),</span>
<span id="cb60-8"><a href="vrije-ruimte.html#cb60-8" tabindex="-1"></a>    <span class="at">CDR3.nt =</span> <span class="fu">paste0</span>(<span class="st">&quot;ATG&quot;</span>, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;GCT&quot;</span>, <span class="st">&quot;GGA&quot;</span>, <span class="st">&quot;TTC&quot;</span>, <span class="st">&quot;AAG&quot;</span>, <span class="st">&quot;CCC&quot;</span>, <span class="st">&quot;TTT&quot;</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="st">&quot;TAA&quot;</span>),</span>
<span id="cb60-9"><a href="vrije-ruimte.html#cb60-9" tabindex="-1"></a>    <span class="at">CDR3.aa =</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;ASS&quot;</span>, <span class="st">&quot;ARR&quot;</span>, <span class="st">&quot;SFS&quot;</span>, <span class="st">&quot;CAG&quot;</span>, <span class="st">&quot;YFG&quot;</span>, <span class="st">&quot;GGG&quot;</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="st">&quot;F&quot;</span>),</span>
<span id="cb60-10"><a href="vrije-ruimte.html#cb60-10" tabindex="-1"></a>    <span class="at">V.name =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;TRBV7-9&quot;</span>, <span class="st">&quot;TRBV20-1&quot;</span>, <span class="st">&quot;TRBV5-1&quot;</span>, <span class="st">&quot;TRBV6-5&quot;</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-11"><a href="vrije-ruimte.html#cb60-11" tabindex="-1"></a>    <span class="at">D.name =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;TRBD1&quot;</span>, <span class="st">&quot;TRBD2&quot;</span>, <span class="cn">NA</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-12"><a href="vrije-ruimte.html#cb60-12" tabindex="-1"></a>    <span class="at">J.name =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;TRBJ2-1&quot;</span>, <span class="st">&quot;TRBJ1-2&quot;</span>, <span class="st">&quot;TRBJ2-7&quot;</span>, <span class="st">&quot;TRBJ1-1&quot;</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-13"><a href="vrije-ruimte.html#cb60-13" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">sample</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">150</span>, n),</span>
<span id="cb60-14"><a href="vrije-ruimte.html#cb60-14" tabindex="-1"></a>    <span class="at">Proportion =</span> <span class="cn">NA</span></span>
<span id="cb60-15"><a href="vrije-ruimte.html#cb60-15" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> df</span>
<span id="cb60-16"><a href="vrije-ruimte.html#cb60-16" tabindex="-1"></a>  df<span class="sc">$</span>Proportion <span class="ot">&lt;-</span> df<span class="sc">$</span>Count <span class="sc">/</span> <span class="fu">sum</span>(df<span class="sc">$</span>Count)</span>
<span id="cb60-17"><a href="vrije-ruimte.html#cb60-17" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb60-18"><a href="vrije-ruimte.html#cb60-18" tabindex="-1"></a>}</span>
<span id="cb60-19"><a href="vrije-ruimte.html#cb60-19" tabindex="-1"></a></span>
<span id="cb60-20"><a href="vrije-ruimte.html#cb60-20" tabindex="-1"></a><span class="co"># Genereer 4 samples</span></span>
<span id="cb60-21"><a href="vrije-ruimte.html#cb60-21" tabindex="-1"></a>sample1 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>()</span>
<span id="cb60-22"><a href="vrije-ruimte.html#cb60-22" tabindex="-1"></a>sample2 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>()</span>
<span id="cb60-23"><a href="vrije-ruimte.html#cb60-23" tabindex="-1"></a>sample3 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>()</span>
<span id="cb60-24"><a href="vrije-ruimte.html#cb60-24" tabindex="-1"></a>sample4 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>()</span>
<span id="cb60-25"><a href="vrije-ruimte.html#cb60-25" tabindex="-1"></a></span>
<span id="cb60-26"><a href="vrije-ruimte.html#cb60-26" tabindex="-1"></a><span class="co"># Combineer in een immunarch-compatibele lijst</span></span>
<span id="cb60-27"><a href="vrije-ruimte.html#cb60-27" tabindex="-1"></a>genomics <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb60-28"><a href="vrije-ruimte.html#cb60-28" tabindex="-1"></a>genomics<span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb60-29"><a href="vrije-ruimte.html#cb60-29" tabindex="-1"></a>  <span class="at">Gen1 =</span> sample1,</span>
<span id="cb60-30"><a href="vrije-ruimte.html#cb60-30" tabindex="-1"></a>  <span class="at">Gen2 =</span> sample2,</span>
<span id="cb60-31"><a href="vrije-ruimte.html#cb60-31" tabindex="-1"></a>  <span class="at">Gen3 =</span> sample3,</span>
<span id="cb60-32"><a href="vrije-ruimte.html#cb60-32" tabindex="-1"></a>  <span class="at">Gen4 =</span> sample4</span>
<span id="cb60-33"><a href="vrije-ruimte.html#cb60-33" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="vrije-ruimte.html#cb61-1" tabindex="-1"></a>genomics</span></code></pre></div>
<pre><code>## $data
## $data$Gen1
##    Clonotype   CDR3.nt CDR3.aa   V.name D.name  J.name Count Proportion
## 1     Clone1 ATGTTCTAA   CGGGF  TRBV7-9  TRBD2 TRBJ2-1    43 0.06213873
## 2     Clone2 ATGTTTTAA   CASSF  TRBV7-9  TRBD1 TRBJ1-2    78 0.11271676
## 3     Clone3 ATGTTCTAA   CARRF  TRBV5-1   &lt;NA&gt; TRBJ2-7    81 0.11705202
## 4     Clone4 ATGGGATAA   CSFSF  TRBV6-5   &lt;NA&gt; TRBJ2-7    85 0.12283237
## 5     Clone5 ATGGGATAA   CYFGF TRBV20-1  TRBD1 TRBJ1-1    72 0.10404624
## 6     Clone6 ATGTTTTAA   CSFSF  TRBV5-1   &lt;NA&gt; TRBJ2-1   106 0.15317919
## 7     Clone7 ATGTTCTAA   CSFSF TRBV20-1  TRBD2 TRBJ2-7   100 0.14450867
## 8     Clone8 ATGCCCTAA   CASSF  TRBV7-9  TRBD1 TRBJ2-1    47 0.06791908
## 9     Clone9 ATGAAGTAA   CCAGF TRBV20-1   &lt;NA&gt; TRBJ2-7    30 0.04335260
## 10   Clone10 ATGTTTTAA   CASSF  TRBV5-1  TRBD1 TRBJ1-1    50 0.07225434
## 
## $data$Gen2
##    Clonotype   CDR3.nt CDR3.aa   V.name D.name  J.name Count Proportion
## 1     Clone1 ATGGGATAA   CARRF TRBV20-1   &lt;NA&gt; TRBJ1-2   107 0.13161132
## 2     Clone2 ATGAAGTAA   CASSF  TRBV7-9  TRBD1 TRBJ1-2    83 0.10209102
## 3     Clone3 ATGAAGTAA   CARRF  TRBV6-5  TRBD2 TRBJ2-7   136 0.16728167
## 4     Clone4 ATGTTTTAA   CCAGF TRBV20-1  TRBD2 TRBJ2-1    26 0.03198032
## 5     Clone5 ATGTTTTAA   CYFGF  TRBV7-9   &lt;NA&gt; TRBJ2-1    55 0.06765068
## 6     Clone6 ATGTTCTAA   CYFGF  TRBV5-1  TRBD2 TRBJ1-1    63 0.07749077
## 7     Clone7 ATGTTTTAA   CGGGF  TRBV5-1  TRBD1 TRBJ2-7   119 0.14637146
## 8     Clone8 ATGTTTTAA   CSFSF  TRBV6-5   &lt;NA&gt; TRBJ1-2   103 0.12669127
## 9     Clone9 ATGGCTTAA   CASSF  TRBV6-5   &lt;NA&gt; TRBJ1-2    88 0.10824108
## 10   Clone10 ATGTTTTAA   CCAGF TRBV20-1   &lt;NA&gt; TRBJ1-2    33 0.04059041
## 
## $data$Gen3
##    Clonotype   CDR3.nt CDR3.aa   V.name D.name  J.name Count Proportion
## 1     Clone1 ATGGCTTAA   CYFGF TRBV20-1   &lt;NA&gt; TRBJ2-1   118 0.15147625
## 2     Clone2 ATGTTCTAA   CSFSF  TRBV7-9  TRBD1 TRBJ1-2   116 0.14890886
## 3     Clone3 ATGCCCTAA   CCAGF  TRBV5-1  TRBD2 TRBJ2-7    86 0.11039795
## 4     Clone4 ATGGGATAA   CCAGF TRBV20-1  TRBD2 TRBJ1-1    45 0.05776637
## 5     Clone5 ATGTTTTAA   CGGGF  TRBV6-5  TRBD1 TRBJ2-7    25 0.03209243
## 6     Clone6 ATGTTTTAA   CCAGF  TRBV7-9  TRBD2 TRBJ2-1   134 0.17201540
## 7     Clone7 ATGTTCTAA   CYFGF  TRBV5-1   &lt;NA&gt; TRBJ2-7    42 0.05391528
## 8     Clone8 ATGGGATAA   CSFSF  TRBV6-5   &lt;NA&gt; TRBJ1-1    49 0.06290116
## 9     Clone9 ATGCCCTAA   CASSF  TRBV6-5  TRBD1 TRBJ1-2    19 0.02439024
## 10   Clone10 ATGTTTTAA   CGGGF  TRBV5-1  TRBD2 TRBJ2-1   145 0.18613607
## 
## $data$Gen4
##    Clonotype   CDR3.nt CDR3.aa   V.name D.name  J.name Count Proportion
## 1     Clone1 ATGCCCTAA   CASSF  TRBV7-9  TRBD1 TRBJ1-2    50 0.05995204
## 2     Clone2 ATGGCTTAA   CYFGF  TRBV6-5  TRBD1 TRBJ1-2   143 0.17146283
## 3     Clone3 ATGGGATAA   CYFGF TRBV20-1  TRBD1 TRBJ2-1   102 0.12230216
## 4     Clone4 ATGCCCTAA   CSFSF  TRBV5-1  TRBD1 TRBJ1-2    66 0.07913669
## 5     Clone5 ATGAAGTAA   CARRF  TRBV7-9   &lt;NA&gt; TRBJ2-1    75 0.08992806
## 6     Clone6 ATGGGATAA   CYFGF  TRBV5-1  TRBD2 TRBJ2-1    13 0.01558753
## 7     Clone7 ATGTTTTAA   CGGGF TRBV20-1  TRBD2 TRBJ1-2    83 0.09952038
## 8     Clone8 ATGGGATAA   CYFGF  TRBV6-5  TRBD2 TRBJ2-7   142 0.17026379
## 9     Clone9 ATGTTCTAA   CSFSF  TRBV6-5   &lt;NA&gt; TRBJ2-1   126 0.15107914
## 10   Clone10 ATGGCTTAA   CSFSF  TRBV7-9  TRBD1 TRBJ2-7    34 0.04076739</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="vrije-ruimte.html#cb63-1" tabindex="-1"></a><span class="fu">repOverlap</span>(genomics<span class="sc">$</span>data) <span class="sc">%&gt;%</span> <span class="fu">vis</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="vrije-ruimte.html#cb64-1" tabindex="-1"></a><span class="co">#repExplore(genomics$data, .method = &quot;volume&quot;)</span></span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="plan-voor-de-toekomst.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-management.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
